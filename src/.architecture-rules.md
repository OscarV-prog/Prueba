# Architecture Rules - Clean Architecture Layering

This document defines the strict layering boundaries for the **prueba** project. All developers (human and AI) must adhere to these constraints.

## Layering Constraints

### 1. Controllers (Http Layer)
- **Location**: `src/app/api/v1/`
- **Pattern**: Next.js Route Handlers.
- **Responsibilities**:
  - Receive HTTP requests.
  - Validate input using Zod DTOs.
  - Call the appropriate Service method.
  - Map Domain Errors to HTTP Status Codes.
  - Return standardized JSON responses (`{ data, meta }`).
- **Strict Prohibition**: 
  - NEVER contain business logic.
  - NEVER import Prisma or call the database directly.

### 2. Services (Domain Layer)
- **Location**: `src/modules/{domain}/*.service.ts`
- **Responsibilities**:
  - Implement core business rules and logic.
  - Perform RBAC (Role-Based Access Control) checks.
  - Coordinate transactions across multiple repositories if necessary.
- **Strict Prohibition**: 
  - NEVER depend on HTTP context (NextRequest, Params, etc.).
  - NEVER call Controllers.

### 3. Repositories (Data Access Layer)
- **Location**: `src/modules/{domain}/*.repository.ts`
- **Responsibilities**:
  - Perform raw data operations using Prisma.
  - Abstract database-specific queries from the business logic.
- **Strict Prohibition**: 
  - ONLY place where Prisma is imported.

## Naming Conventions
- **Files**: Use dot notation (e.g., `tasks.service.ts`, `tasks.dto.ts`).
- **Database**: Use `snake_case` for tables and columns in Postgres.
- **Code**: Use `camelCase` for functions and `PascalCase` for components/classes.
